@using EDI_suppliers.Data

@page "/listsuppliersmfg"

@inject CustomHttpClient Http
@inject AppSettingsService AppSettingsService
@inject AuthenticationStateProvider AuthenticationStateProvider

    <h2>Přehled MFG Dodavatelů</h2>
            <p>
                <a href="/addsuppliermfg">Vytvořit nového dodavatele</a>
            </p>

            @if (supplierMFGs == null)
            {
                <h3>Načítání....</h3>
            }
            else
            {
                <table class='table'>
                    <thead>
                        <tr>
                            <th>Dodavatel MFG</th>
                            <th>Jméno dodavatele</th>
                            <th>Kontakt IT</th>
                            <th>Kontakt Log</th>
                            <th>EDI</th>
                            <th>EDI Partner</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var suppliermfg in supplierMFGs)
                        {
                        <tr>
                            <td>@suppliermfg.MfgId</td>
                            <td>@suppliermfg.Name</td>
                            <td>@suppliermfg.ContactIt</td>
                            <td>@suppliermfg.ContactLog</td>
                            <td>@suppliermfg.Edi</td>
                            <td>@suppliermfg.ConnectionEdi</td>
                            <td>
                                <a href='/editsuppliermfg/@suppliermfg.Id'>Edit</a>
                                <a href='/deletesuppliermfg/@suppliermfg.Id'>Delete</a>
                            </td>
                        </tr>

                        }
                    </tbody>
                </table>
            }

        @code {

            // AuthenticationState is available as a CascadingParameter
            [CascadingParameter]
            private Task<AuthenticationState> authenticationStateTask { get; set; }


            SupplierMFG[] supplierMFGs;
            string baseUrl;

            protected override async Task OnInitializedAsync()
            {
                baseUrl = AppSettingsService.GetBaseUrl();
                supplierMFGs = await Http.GetJsonAsync<SupplierMFG[]>(baseUrl + "/api/suppliermfg/get");
            }
        }
